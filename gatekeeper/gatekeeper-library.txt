 
https://github.com/open-policy-agent/gatekeeper-library/tree/master/library
https://github.com/open-policy-agent/gatekeeper-library/tree/master/src

https://www.openpolicyagent.org/docs/latest/policy-reference/#built-in-functions


General ->
1. ServiceAccount:
    No updation
    No Automounting
2. ClusterRole: 
    `system:aggregate-to-edit` cluster role
    `system:anonymous`, `system:unauthenticated`
3. container resources:
    Limits
    Requests
    req-lim ratio
    req-lim exists
4. image:
    Allowed Repository
    Tag
    Digest
5. Service/Ingress:
    Loadbalancer type services
    Nodeport services
    serviceSelectors to be unique in a ns
    service externalIPs to be on a range
    Wildcard ingress
    Ingress has to be httpsonly
    All ingress rule hosts to be unique
6. PDB, replica limit, required annotations, labels, probes
7. StorageClassname in pvc






PodSecurityPolicy -> 

Using pod.securityContext :
1. runAsUser, runAsGroup
2. seLinuxOptions
3. capabilities
4. sysctls
5. allowPriviledgeEscalation

Using PSP.spec :
1. Priviledged
2. fsGroup, supplementalGroups
3. readOnlyRootFileSystem
4. Host related : allowedHostPaths, HostPID, HostIPC, hostPorts, hostNetwork
5. allowedProcMountTypes

Others :
1. AppArmor, seccomp: psp or pod annotations
2. pod.volumes.flexVolumes